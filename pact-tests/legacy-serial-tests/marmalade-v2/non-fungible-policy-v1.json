{"dependencies":[["marmalade-v2.policy-manager.enforce-offer.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":{"list":"bool"}},"defName":"enforce-offer","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"OFFER-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-offer"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"var":{"b":4},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.enforce-sale-pact.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"pact-id"}},"i":null}},"i":null},"info":null},{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"tx-hash"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null},"info":null},{"i":null,"lit":"cannot be triggered as nested defpacts"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"quote"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.exists-msg-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.validate-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quotes","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"insert"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"guard"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"account","type":"string","info":{"d":[7,3727,3727],"c":"account"}},{"name":"guard","type":{"guard":null},"info":{"d":[5,3749,3749],"c":"guard"}}],"return":"string"},"defName":"create-account","defBody":{"scope":{"list":[],"type":"*","i":{"d":[160,3691,3691],"c":"(defun create-account:string\n     ( account:string\n       guard:guard\n     )\n     \" Create ACCOUNT with 0.0 balance, with GUARD controlling access.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Create ACCOUNT with 0.0 balance, with GUARD controlling access."},"info":{"d":[160,3691,3691],"c":"(defun create-account:string\n     ( account:string\n       guard:guard\n     )\n     \" Create ACCOUNT with 0.0 balance, with GUARD controlling access.\"\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.QUOTE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"emit-event"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"quote","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"obj":{"amount":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":2},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"token-id":{"var":{"b":0},"i":null},"seller":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":1},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"timeout":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":3},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"keyorder":["token-id","seller","amount","timeout"],"type":"*","i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"+"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"token-id","type":"string","info":null},"val":{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"escrow-account","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-escrow-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"fungible","type":{"modspec":[{"var":{"f":{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}},"i":null}},"i":null}]},"info":null},"val":{"args":[{"i":null,"lit":"fungible"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"quote-spec","type":{"schema":"object","type":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-spec","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"quote"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"i":null,"lit":true}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null},"info":null},{"args":[{"amArg":"`af15","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"r","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.OFFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-offer","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":"Offer policy of sale SALE-ID by SELLER of AMOUNT of TOKEN."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"q","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":" Executed at `offer` step of marmalade.ledger.                              Required msg-data keys:                                                         * (optional) quote:object{quote-spec} - sale is registered as a quoted fungible  sale if present. If absent, sale proceeds without quotes."},"info":null}}],["marmalade-v2.policy-manager.exists-msg-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"msg","type":"string","info":null}],"return":"bool"},"defName":"exists-msg-quote","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"var":{"b":0},"i":null},{"obj":{},"keyorder":[],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"!="}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"o","type":{"schema":"object","type":"*","partial":"full"},"info":null},"val":{"args":[{"obj":{},"keyorder":[],"type":"*","i":null},{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"try"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Checks env-data field and see if the msg is a object"},"info":null}}],["marmalade-v2.policy-manager.ROYALTY_POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"ROYALTY_POLICY","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"royalty-policy"},"eval":{"var":{"direct":{"pdval":"royalty-policy"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.GOVERNANCE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[],"return":{"tag":"TypeVar","name":"a","constraint":[]}},"defName":"GOVERNANCE","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce-guard"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.BUYER-FUNGIBLE-ACCOUNT-MSG-KEY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"BUYER-FUNGIBLE-ACCOUNT-MSG-KEY","type":"string","info":null},"meta":{"model":[],"docs":"Payload field for buyer's fungible account"},"val":{"raw":{"i":null,"lit":"buyer_fungible_account"},"eval":{"var":{"direct":{"pdval":"buyer_fungible_account"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.MARKETPLACE-FEE-KEY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"MARKETPLACE-FEE-KEY","type":{"tag":"TypeVar","name":"b","constraint":[]},"info":null},"meta":{"model":[],"docs":"Payload field for marketplace fee spec"},"val":{"raw":{"i":null,"lit":"marketplace_fee"},"eval":{"var":{"direct":{"pdval":"marketplace_fee"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.BUY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"BUY","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Capability to grant internal transaction inside BUY"},"info":null}}],["marmalade-v2.policy-manager.enforce-buy.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"buyer-guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null}],"return":{"list":"bool"}},"defName":"enforce-buy","defBody":{"scope":{"list":[{"args":[{"var":{"b":5},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.enforce-sale-pact.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"var":{"f":{"var":{"b":5},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"BUY-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-buy"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"args":[{"var":{"b":5},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.exists-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"i":null,"lit":""}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"!="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"updated_price"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.exists-msg-decimal.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"args":[{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"amount","type":"decimal","info":{"d":[6,3603,3603],"c":"amount"}}],"return":"bool"},"defName":"enforce-unit","defBody":{"scope":{"list":[],"type":"*","i":{"d":[120,3571,3571],"c":"(defun enforce-unit:bool\n     ( amount:decimal )\n     \" Enforce minimum precision allowed for transactions.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Enforce minimum precision allowed for transactions."},"info":{"d":[120,3571,3571],"c":"(defun enforce-unit:bool\n     ( amount:decimal )\n     \" Enforce minimum precision allowed for transactions.\"\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null},{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.UPDATE-QUOTE-PRICE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quotes","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"obj":{"sale-price":{"var":{"b":0},"i":null}},"keyorder":["sale-price"],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"update"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"type":"*","i":null}},"pairs":[{"arg":{"name":"updated-price","type":"decimal","info":null},"val":{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"updated_price"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"i":null,"lit":true}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":">"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Price is not finalized for this quote"}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"i":null,"lit":0},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":true},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.FUNGIBLE-TRANSFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"args":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":">="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"i":null,"lit":1}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"<="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"and"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Invalid market-fee percentage"}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"buyer_fungible_account"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"mk-account"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":{"managedParam":"amount","managerFun":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"managed","type":"decimal","info":{"d":[7,780,780],"c":"managed"}},{"name":"requested","type":"decimal","info":{"d":[9,803,803],"c":"requested"}}],"return":"decimal"},"defName":"TRANSFER-mgr","defBody":{"scope":{"list":[],"type":"*","i":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Manages TRANSFER AMOUNT linearly,  such that a request for 1.0 amount on a 3.0  managed quantity emits updated amount 2.0."},"info":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"i":{"d":[18,721,721],"c":"TRANSFER-mgr\n     "}}},"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,489,489],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,510,510],"c":"receiver"}},{"name":"amount","type":"decimal","info":{"d":[6,533,533],"c":"amount"}}],"return":"bool"},"defName":"TRANSFER","defBody":{"scope":{"list":[],"type":"*","i":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Managed capability sealing AMOUNT for transfer from SENDER to  RECEIVER. Permits any number of transfers up to AMOUNT."},"info":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"install-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"buyer_fungible_account"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"mk-account"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,1126,1126],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,1146,1146],"c":"receiver"}},{"name":"amount","type":"decimal","info":{"d":[6,1168,1168],"c":"amount"}}],"return":"string"},"defName":"transfer","defBody":{"scope":{"list":[],"type":"*","i":{"d":[409,1097,1097],"c":"(defun transfer:string\n    ( sender:string\n      receiver:string\n      amount:decimal\n    )\n    @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n         \\ Fails if either SENDER or RECEIVER does not exist.\"\n    @model [ (property (> amount 0.0))\n             (property (!= sender \"\"))\n             (property (!= receiver \"\"))\n             (property (!= sender receiver))\n           ]\n    )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":{"d":[9,1333,1333],"c":"property "}},{"list":[{"atom":">","q":[],"i":{"d":[2,1343,1343],"c":"> "}},{"atom":"amount","q":[],"i":{"d":[7,1345,1345],"c":"amount "}},{"i":{"d":[3,1352,1352],"c":"0.0"},"lit":0}],"d":"()","i":{"d":[14,1342,1342],"c":"(> amount 0.0)"}}],"d":"()","i":{"d":[39,1332,1332],"c":"(property (> amount 0.0))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1372,1372],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1382,1382],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,1385,1385],"c":"sender "}},{"i":{"d":[2,1392,1392],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[14,1381,1381],"c":"(!= sender \"\")"}}],"d":"()","i":{"d":[39,1371,1371],"c":"(property (!= sender \"\"))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1411,1411],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1421,1421],"c":"!= "}},{"atom":"receiver","q":[],"i":{"d":[9,1424,1424],"c":"receiver "}},{"i":{"d":[2,1433,1433],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[16,1420,1420],"c":"(!= receiver \"\")"}}],"d":"()","i":{"d":[41,1410,1410],"c":"(property (!= receiver \"\"))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1452,1452],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1462,1462],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,1465,1465],"c":"sender "}},{"atom":"receiver","q":[],"i":{"d":[8,1472,1472],"c":"receiver"}}],"d":"()","i":{"d":[20,1461,1461],"c":"(!= sender receiver)"}}],"d":"()","i":{"d":[43,1451,1451],"c":"(property (!= sender receiver))\n           "}}],"docs":" Transfer AMOUNT between accounts SENDER and RECEIVER.  Fails if either SENDER or RECEIVER does not exist."},"info":{"d":[409,1097,1097],"c":"(defun transfer:string\n    ( sender:string\n      receiver:string\n      amount:decimal\n    )\n    @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n         \\ Fails if either SENDER or RECEIVER does not exist.\"\n    @model [ (property (> amount 0.0))\n             (property (!= sender \"\"))\n             (property (!= receiver \"\"))\n             (property (!= sender receiver))\n           ]\n    )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.FUNGIBLE-TRANSFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"buyer_fungible_account"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":{"managedParam":"amount","managerFun":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"managed","type":"decimal","info":{"d":[7,780,780],"c":"managed"}},{"name":"requested","type":"decimal","info":{"d":[9,803,803],"c":"requested"}}],"return":"decimal"},"defName":"TRANSFER-mgr","defBody":{"scope":{"list":[],"type":"*","i":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Manages TRANSFER AMOUNT linearly,  such that a request for 1.0 amount on a 3.0  managed quantity emits updated amount 2.0."},"info":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"i":{"d":[18,721,721],"c":"TRANSFER-mgr\n     "}}},"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,489,489],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,510,510],"c":"receiver"}},{"name":"amount","type":"decimal","info":{"d":[6,533,533],"c":"amount"}}],"return":"bool"},"defName":"TRANSFER","defBody":{"scope":{"list":[],"type":"*","i":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Managed capability sealing AMOUNT for transfer from SENDER to  RECEIVER. Permits any number of transfers up to AMOUNT."},"info":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"install-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"buyer_fungible_account"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"guard"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,1543,1543],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,1564,1564],"c":"receiver"}},{"name":"receiver-guard","type":{"guard":null},"info":{"d":[14,1587,1587],"c":"receiver-guard"}},{"name":"amount","type":"decimal","info":{"d":[6,1615,1615],"c":"amount"}}],"return":"string"},"defName":"transfer-create","defBody":{"scope":{"list":[],"type":"*","i":{"d":[656,1506,1506],"c":"(defun transfer-create:string\n     ( sender:string\n       receiver:string\n       receiver-guard:guard\n       amount:decimal\n     )\n     @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n          \\ Fails if SENDER does not exist. If RECEIVER exists, guard \\\n          \\ must match existing value. If RECEIVER does not exist, \\\n          \\ RECEIVER account is created using RECEIVER-GUARD. \\\n          \\ Subject to management by TRANSFER capability.\"\n     @model [ (property (> amount 0.0))\n              (property (!= sender \"\"))\n              (property (!= receiver \"\"))\n              (property (!= sender receiver))\n            ]\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":{"d":[9,1984,1984],"c":"property "}},{"list":[{"atom":">","q":[],"i":{"d":[2,1994,1994],"c":"> "}},{"atom":"amount","q":[],"i":{"d":[7,1996,1996],"c":"amount "}},{"i":{"d":[3,2003,2003],"c":"0.0"},"lit":0}],"d":"()","i":{"d":[14,1993,1993],"c":"(> amount 0.0)"}}],"d":"()","i":{"d":[40,1983,1983],"c":"(property (> amount 0.0))\n              "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,2024,2024],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,2034,2034],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,2037,2037],"c":"sender "}},{"i":{"d":[2,2044,2044],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[14,2033,2033],"c":"(!= sender \"\")"}}],"d":"()","i":{"d":[40,2023,2023],"c":"(property (!= sender \"\"))\n              "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,2064,2064],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,2074,2074],"c":"!= "}},{"atom":"receiver","q":[],"i":{"d":[9,2077,2077],"c":"receiver "}},{"i":{"d":[2,2086,2086],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[16,2073,2073],"c":"(!= receiver \"\")"}}],"d":"()","i":{"d":[42,2063,2063],"c":"(property (!= receiver \"\"))\n              "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,2106,2106],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,2116,2116],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,2119,2119],"c":"sender "}},{"atom":"receiver","q":[],"i":{"d":[8,2126,2126],"c":"receiver"}}],"d":"()","i":{"d":[20,2115,2115],"c":"(!= sender receiver)"}}],"d":"()","i":{"d":[44,2105,2105],"c":"(property (!= sender receiver))\n            "}}],"docs":" Transfer AMOUNT between accounts SENDER and RECEIVER.  Fails if SENDER does not exist. If RECEIVER exists, guard  must match existing value. If RECEIVER does not exist,  RECEIVER account is created using RECEIVER-GUARD.  Subject to management by TRANSFER capability."},"info":{"d":[656,1506,1506],"c":"(defun transfer-create:string\n     ( sender:string\n       receiver:string\n       receiver-guard:guard\n       amount:decimal\n     )\n     @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n          \\ Fails if SENDER does not exist. If RECEIVER exists, guard \\\n          \\ must match existing value. If RECEIVER does not exist, \\\n          \\ RECEIVER account is created using RECEIVER-GUARD. \\\n          \\ Subject to management by TRANSFER capability.\"\n     @model [ (property (> amount 0.0))\n              (property (!= sender \"\"))\n              (property (!= receiver \"\"))\n              (property (!= sender receiver))\n            ]\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.ESCROW.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":{"managedParam":"amount","managerFun":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"managed","type":"decimal","info":{"d":[7,780,780],"c":"managed"}},{"name":"requested","type":"decimal","info":{"d":[9,803,803],"c":"requested"}}],"return":"decimal"},"defName":"TRANSFER-mgr","defBody":{"scope":{"list":[],"type":"*","i":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Manages TRANSFER AMOUNT linearly,  such that a request for 1.0 amount on a 3.0  managed quantity emits updated amount 2.0."},"info":{"d":[352,745,745],"c":"(defun TRANSFER-mgr:decimal\n     ( managed:decimal\n       requested:decimal\n     )\n     @doc \" Manages TRANSFER AMOUNT linearly, \\\n          \\ such that a request for 1.0 amount on a 3.0 \\\n          \\ managed quantity emits updated amount 2.0.\"\n     )\n\n   ; ----------------------------------------------------------------------\n   ; Functionality\n\n\n  "}}},"i":{"d":[18,721,721],"c":"TRANSFER-mgr\n     "}}},"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,489,489],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,510,510],"c":"receiver"}},{"name":"amount","type":"decimal","info":{"d":[6,533,533],"c":"amount"}}],"return":"bool"},"defName":"TRANSFER","defBody":{"scope":{"list":[],"type":"*","i":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Managed capability sealing AMOUNT for transfer from SENDER to  RECEIVER. Permits any number of transfers up to AMOUNT."},"info":{"d":[285,460,460],"c":"(defcap TRANSFER:bool\n     ( sender:string\n       receiver:string\n       amount:decimal\n     )\n     @doc \" Managed capability sealing AMOUNT for transfer from SENDER to \\\n          \\ RECEIVER. Permits any number of transfers up to AMOUNT.\"\n     @managed amount TRANSFER-mgr\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"install-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sender","type":"string","info":{"d":[6,1126,1126],"c":"sender"}},{"name":"receiver","type":"string","info":{"d":[8,1146,1146],"c":"receiver"}},{"name":"amount","type":"decimal","info":{"d":[6,1168,1168],"c":"amount"}}],"return":"string"},"defName":"transfer","defBody":{"scope":{"list":[],"type":"*","i":{"d":[409,1097,1097],"c":"(defun transfer:string\n    ( sender:string\n      receiver:string\n      amount:decimal\n    )\n    @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n         \\ Fails if either SENDER or RECEIVER does not exist.\"\n    @model [ (property (> amount 0.0))\n             (property (!= sender \"\"))\n             (property (!= receiver \"\"))\n             (property (!= sender receiver))\n           ]\n    )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":{"d":[9,1333,1333],"c":"property "}},{"list":[{"atom":">","q":[],"i":{"d":[2,1343,1343],"c":"> "}},{"atom":"amount","q":[],"i":{"d":[7,1345,1345],"c":"amount "}},{"i":{"d":[3,1352,1352],"c":"0.0"},"lit":0}],"d":"()","i":{"d":[14,1342,1342],"c":"(> amount 0.0)"}}],"d":"()","i":{"d":[39,1332,1332],"c":"(property (> amount 0.0))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1372,1372],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1382,1382],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,1385,1385],"c":"sender "}},{"i":{"d":[2,1392,1392],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[14,1381,1381],"c":"(!= sender \"\")"}}],"d":"()","i":{"d":[39,1371,1371],"c":"(property (!= sender \"\"))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1411,1411],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1421,1421],"c":"!= "}},{"atom":"receiver","q":[],"i":{"d":[9,1424,1424],"c":"receiver "}},{"i":{"d":[2,1433,1433],"c":"\"\""},"lit":""}],"d":"()","i":{"d":[16,1420,1420],"c":"(!= receiver \"\")"}}],"d":"()","i":{"d":[41,1410,1410],"c":"(property (!= receiver \"\"))\n             "}},{"list":[{"atom":"property","q":[],"i":{"d":[9,1452,1452],"c":"property "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,1462,1462],"c":"!= "}},{"atom":"sender","q":[],"i":{"d":[7,1465,1465],"c":"sender "}},{"atom":"receiver","q":[],"i":{"d":[8,1472,1472],"c":"receiver"}}],"d":"()","i":{"d":[20,1461,1461],"c":"(!= sender receiver)"}}],"d":"()","i":{"d":[43,1451,1451],"c":"(property (!= sender receiver))\n           "}}],"docs":" Transfer AMOUNT between accounts SENDER and RECEIVER.  Fails if either SENDER or RECEIVER does not exist."},"info":{"d":[409,1097,1097],"c":"(defun transfer:string\n    ( sender:string\n      receiver:string\n      amount:decimal\n    )\n    @doc \" Transfer AMOUNT between accounts SENDER and RECEIVER. \\\n         \\ Fails if either SENDER or RECEIVER does not exist.\"\n    @model [ (property (> amount 0.0))\n             (property (!= sender \"\"))\n             (property (!= receiver \"\"))\n             (property (!= sender receiver))\n           ]\n    )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"balance","type":"decimal","info":null},"val":{"args":[{"args":[{"i":null,"lit":"account"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"account","type":"string","info":{"d":[7,3216,3216],"c":"account"}}],"return":"decimal"},"defName":"get-balance","defBody":{"scope":{"list":[],"type":"*","i":{"d":[128,3182,3182],"c":"(defun get-balance:decimal\n     ( account:string )\n     \" Get balance for ACCOUNT. Fails if account does not exist.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Get balance for ACCOUNT. Fails if account does not exist."},"info":{"d":[128,3182,3182],"c":"(defun get-balance:decimal\n     ( account:string )\n     \" Get balance for ACCOUNT. Fails if account does not exist.\"\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}}],"type":"let","i":null},{"var":{"b":0},"i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"result","type":{"list":"bool"},"info":null},"val":{"args":[{"amArg":"`af21","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":1},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":2},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"x","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.BUY-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":1},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":2},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":3},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"buyer-guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-buy","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":"Buy policy on SALE-ID by SELLER to BUYER AMOUNT of TOKEN."},"info":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"w","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"mk-fee","type":"decimal","info":null},"val":{"args":[{"args":[{"var":{"b":0},"i":null},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"*"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[],"return":"integer"},"defName":"precision","defBody":{"scope":{"list":[],"type":"*","i":{"d":[97,3474,3474],"c":"(defun precision:integer\n     ()\n     \"Return the maximum allowed decimal precision.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":"Return the maximum allowed decimal precision."},"info":{"d":[97,3474,3474],"c":"(defun precision:integer\n     ()\n     \"Return the maximum allowed decimal precision.\"\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"floor"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"mk-fee-percentage","type":"decimal","info":null},"val":{"args":[{"i":null,"lit":"mk-fee-percentage"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"mk-fee-spec","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"marketplace-fee-spec","meta":{"model":[],"docs":"Marketplace fee data to include in payload"},"i":null,"fields":[{"name":"mk-account","type":"string","info":null},{"name":"mk-fee-percentage","type":"decimal","info":null}]}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"obj":{"mk-account":{"i":null,"lit":""},"mk-fee-percentage":{"i":null,"lit":0}},"keyorder":["mk-account","mk-fee-percentage"],"type":"*","i":null},{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marketplace_fee"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"try"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"final-sale-price","type":"decimal","info":null},"val":{"args":[{"i":null,"lit":"sale-price"},{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":5},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-quote-info.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-price","type":"decimal","info":null},"val":{"args":[{"i":null,"lit":"sale-price"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-type","type":"string","info":null},"val":{"args":[{"i":null,"lit":"sale-type"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"i":null,"lit":"seller-fungible-account"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"fungible","type":{"modspec":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}},"i":null}},"i":null}},"i":null}]},"info":null},"val":{"args":[{"i":null,"lit":"fungible"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"quote-spec","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"var":{"f":{"var":{"b":5},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-quote-info.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"escrow-account","type":{"schema":"object","type":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"var":{"b":5},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-escrow-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af24","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"var":{"f":{"var":{"b":5},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"aa","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.BUY-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"var":{"f":{"var":{"b":5},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"buyer-guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-buy","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":"Buy policy on SALE-ID by SELLER to BUYER AMOUNT of TOKEN."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"z","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":" Executed at `buy` step of marmalade.ledger.                                  Required msg-data keys:                                                           * (optional) buyer_fungible_account:string - The fungible account of the buyer    which transfers the fungible to the escrow account. Only required if the sale is  a quoted sale. "},"info":null}}],["marmalade-v2.policy-manager.WITHDRAW-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"WITHDRAW-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledger","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"ledger-impl","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]},"info":null}]}}],["marmalade-v2.policy-manager.UPDATE-URI-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"new-uri","type":"string","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"UPDATE-URI-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.CONCRETE_POLICY_LIST.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"CONCRETE_POLICY_LIST","type":{"list":"string"},"info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"list":[{"var":{"ref":{"var":{"direct":{"pdval":"non-fungible-policy"}},"i":null}},"i":null},{"var":{"ref":{"var":{"direct":{"pdval":"royalty-policy"}},"i":null}},"i":null},{"var":{"ref":{"var":{"direct":{"pdval":"collection-policy"}},"i":null}},"i":null},{"var":{"ref":{"var":{"direct":{"pdval":"guard-policy"}},"i":null}},"i":null}],"type":{"tag":"TypeVar","name":"f","constraint":[]},"i":null},"eval":{"var":{"direct":{"pdval":["non-fungible-policy","royalty-policy","collection-policy","guard-policy"]}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.enforce-burn.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":{"list":"bool"}},"defName":"enforce-burn","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"BURN-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-burn"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af12","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"o","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.BURN-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-burn","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"account","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null},{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":">","q":[],"i":null},{"atom":"amount","q":[],"i":null},{"i":null,"lit":0}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Burning policy for TOKEN to ACCOUNT for AMOUNT."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"n","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.get-escrow-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"}},"defName":"get-escrow-account","defBody":{"scope":{"list":[{"obj":{"guard":{"args":[{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.ESCROW.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"create-capability-guard"}},"i":null}},"i":null},"info":null},"account":{"args":[{"args":[{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.ESCROW.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"create-capability-guard"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"create-principal"}},"i":null}},"i":null},"info":null}},"keyorder":["account","guard"],"type":"*","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Returns fungible escrow ACCOUNT and GUARD of the SALE"},"info":null}}],["marmalade-v2.policy-manager.OFFER.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"OFFER","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Capability to grant internal transaction inside OFFER"},"info":null}}],["marmalade-v2.policy-manager.NON_FUNGIBLE_POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"NON_FUNGIBLE_POLICY","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"non-fungible-policy"},"eval":{"var":{"direct":{"pdval":"non-fungible-policy"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.exists-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"exists-quote","defBody":{"scope":{"list":[{"args":[{"i":null,"lit":false},{"body":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"pairs":[{"arg":{"name":"q","type":{"tag":"TypeVar","name":"ah","constraint":[]},"info":null},"val":{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-quote-info.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"try"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Looks up quote table for quote"},"info":null}}],["marmalade-v2.policy-manager.OFFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"OFFER-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.ESCROW.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":{"tag":"TypeVar","name":"c","constraint":[]}},"defName":"ESCROW","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Capability to be used as escrow's capability guard"},"info":null}}],["marmalade-v2.policy-manager.init.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"ledger","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]},"info":null}],"return":"bool"},"defName":"init","defBody":{"scope":{"list":[{"args":[{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.GOVERNANCE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledgers","meta":{"model":[],"docs":"Singleton table for ledger reference storage"},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledger","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"ledger-impl","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"i":null,"lit":""},{"obj":{"ledger-impl":{"var":{"b":0},"i":null}},"keyorder":["ledger-impl"],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"write"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Must be initiated with ledger implementation"},"info":null}}],["marmalade-v2.policy-manager.quote-spec.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-spec","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}}],["marmalade-v2.policy-manager.write-concrete-policy.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"policy-field","type":"string","info":null},{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}],"return":"bool"},"defName":"write-concrete-policy","defBody":{"scope":{"list":[{"args":[{"args":[{"var":{"b":0},"i":null},{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":["non-fungible-policy","royalty-policy","collection-policy","guard-policy"]}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"contains"}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Not registered as concrete policy"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":0},"i":null},{"var":{"b":1},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.CONCRETE-POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policies","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policy","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null},{"obj":{"policy":{"var":{"b":1},"i":null}},"keyorder":["policy"],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"write"}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.get-quote-info.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"partial":"full"}},"defName":"get-quote-info","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quotes","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"read"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Get Quote information"},"info":null}}],["marmalade-v2.policy-manager.get-concrete-policy.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"policy-field","type":"string","info":null}],"return":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"defName":"get-concrete-policy","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policies","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policy","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null},{"body":{"scope":{"list":[{"var":{"b":0},"i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"policy","type":{"tag":"TypeVar","name":"ak","constraint":[]},"info":null},"val":{"i":null,"lit":"policy"}}],"type":{"bind":"*"},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"with-read"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.FUNGIBLE-TRANSFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null}],"return":"bool"},"defName":"FUNGIBLE-TRANSFER-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.COLLECTION_POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"COLLECTION_POLICY","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"collection-policy"},"eval":{"var":{"direct":{"pdval":"collection-policy"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.enforce-withdraw.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":{"list":"bool"}},"defName":"enforce-withdraw","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"WITHDRAW-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-withdraw"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"var":{"b":4},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.enforce-sale-pact.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":4},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.exists-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"var":{"b":0},"i":null},{"i":null,"lit":""}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"!="}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":4},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-withdrawal","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"sale-v2"},"meta":{"model":[],"docs":"Read-only Function that is enforced to allow withdrawal from sale"},"info":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-contract","type":{"modspec":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}},"i":null}},"i":null}},"i":null}]},"info":null},"val":{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-sale.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"i":null,"lit":true}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-type","type":"string","info":null},"val":{"args":[{"i":null,"lit":"sale-type"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"quote-spec","type":{"schema":"object","type":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"var":{"b":4},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.get-quote-info.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"i":null,"lit":true}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null},"info":null},{"args":[{"amArg":"`af18","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"u","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.WITHDRAW-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-withdraw","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":"Withdraw policy on SALE-ID by SELLER of AMOUNT of TOKEN"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"t","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":" Executed at `withdraw` step of marmalade.ledger."},"info":null}}],["marmalade-v2.policy-manager.enforce-update-uri.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"new-uri","type":"string","info":null}],"return":{"list":"bool"}},"defName":"enforce-update-uri","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"new-uri","type":"string","info":null}],"return":"bool"},"defName":"UPDATE-URI-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-update-uri"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af30","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"ag","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.UPDATE-URI-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"new-uri","type":"string","info":null}],"return":"bool"},"defName":"enforce-update-uri","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"updatable-uri-policy-v1"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"new-uri","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Updating the URI of a token."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null},{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"updatable-uri-policy-v1"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"af","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.fungible-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}}],["marmalade-v2.policy-manager.marketplace-fee-spec.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"marketplace-fee-spec","meta":{"model":[],"docs":"Marketplace fee data to include in payload"},"i":null,"fields":[{"name":"mk-account","type":"string","info":null},{"name":"mk-fee-percentage","type":"decimal","info":null}]}}],["marmalade-v2.policy-manager.SALE-GUARD-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null},{"name":"price","type":"decimal","info":null}],"return":"bool"},"defName":"SALE-GUARD-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.sale-contract.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-contract","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"sale-contract","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]},"info":null}]}}],["marmalade-v2.policy-manager.BURN-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"BURN-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.sale-whitelist.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-whitelist","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-contract","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"sale-contract","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}}],["marmalade-v2.policy-manager.enforce-sale-pact.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale","type":"string","info":null}],"return":"bool"},"defName":"enforce-sale-pact","defBody":{"scope":{"list":[{"args":[{"args":[{"var":{"b":0},"i":null},{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"pact-id"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Invalid pact/sale id"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Enforces that SALE is id for currently executing pact"},"info":null}}],["marmalade-v2.policy-manager.SALE-WHITELIST.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":"event","funType":{"args":[{"name":"sale-contract-key","type":"string","info":null}],"return":"bool"},"defName":"SALE-WHITELIST","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce-guard"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[],"return":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]}},"defName":"retrieve-ledger","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledgers","meta":{"model":[],"docs":"Singleton table for ledger reference storage"},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledger","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"ledger-impl","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"i":null,"lit":""},{"body":{"scope":{"list":[{"var":{"b":0},"i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"tag":"TypeVar","name":"ai","constraint":[]},"info":null},"val":{"i":null,"lit":"ledger-impl"}}],"type":{"bind":"*"},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"with-read"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Retrieves the ledger implementation"},"info":null}}],["marmalade-v2.policy-manager.ledgers.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledgers","meta":{"model":[],"docs":"Singleton table for ledger reference storage"},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"ledger","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"ledger-impl","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}}],["marmalade-v2.policy-manager.quote-schema.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}}],["marmalade-v2.policy-manager.UPDATE-QUOTE-PRICE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"token-id","type":"string","info":null},{"name":"sale-id","type":"string","info":null},{"name":"sale-type","type":"string","info":null},{"name":"updated-price","type":"decimal","info":null}],"return":"bool"},"defName":"UPDATE-QUOTE-PRICE","defBody":{"scope":{"list":[{"args":[{"args":[{"var":{"b":3},"i":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":">"}},"i":null}},"i":null},"info":null},{"i":null,"lit":"QUOTE price must be positive"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":1},"i":null},{"var":{"b":3},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.SALE-GUARD-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"compose-capability"}},"i":null}},"i":null},"info":null},{"body":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null},{"name":"price","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-quote-update","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"sale-v2"},"meta":{"model":[],"docs":"Read-only Function that is enforced to update quote price at enforce-buy"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-contract","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[{"var":{"b":2},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-sale.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Enforces sale-guard on update-quote-price"},"info":null}}],["marmalade-v2.policy-manager.INIT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"INIT-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.enforce-mint.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null}],"return":{"list":"bool"}},"defName":"enforce-mint","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"MINT-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-mint"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af9","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"l","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.MINT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-mint","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"account","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null},{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":">","q":[],"i":null},{"atom":"amount","q":[],"i":null},{"i":null,"lit":0}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Minting policy for TOKEN to ACCOUNT for AMOUNT."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"k","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.retrieve-sale.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-type","type":"string","info":null}],"return":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]}},"defName":"retrieve-sale","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-whitelist","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-contract","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"sale-contract","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null},{"body":{"scope":{"list":[{"var":{"b":0},"i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale","type":{"tag":"TypeVar","name":"aj","constraint":[]},"info":null},"val":{"i":null,"lit":"sale-contract"}}],"type":{"bind":"*"},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"with-read"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Retrieves the sale-contract"},"info":null}}],["marmalade-v2.policy-manager.enforce-transfer.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sender","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"receiver","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":{"list":"bool"}},"defName":"enforce-transfer","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"sender","type":"string","info":null},{"name":"receiver","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"TRANSFER-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-transfer"},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af27","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"ad","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.TRANSFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"var":{"f":{"var":{"b":1},"i":null}},"i":null},{"var":{"f":{"var":{"b":2},"i":null}},"i":null},{"var":{"f":{"var":{"b":3},"i":null}},"i":null},{"var":{"f":{"var":{"b":4},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sender","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"receiver","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-transfer","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":" Enforce rules on transfer of TOKEN AMOUNT from SENDER to RECEIVER.  Also governs rotate of SENDER (with same RECEIVER and 0.0 AMOUNT). "},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"ac","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.UPDATED-PRICE-KEY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"UPDATED-PRICE-KEY","type":"string","info":null},"meta":{"model":[],"docs":"Payload field for updated price"},"val":{"raw":{"i":null,"lit":"updated_price"},"eval":{"var":{"direct":{"pdval":"updated_price"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.add-sale-whitelist.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"sale-contract","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]},"info":null}],"return":"bool"},"defName":"add-sale-whitelist","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.SALE-WHITELIST.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"f":{"var":{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-whitelist","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"sale-contract","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"sale-contract","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"sale-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"b":0},"i":null},{"obj":{"sale-contract":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"keyorder":["sale-contract"],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"insert"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-key","type":{"tag":"TypeVar","name":"d","constraint":[]},"info":null},"val":{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"e","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Adds quote-guard to quote-guard-whitelist list"},"info":null}}],["marmalade-v2.policy-manager.validate-fungible-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null}],"return":{"tag":"TypeVar","name":"al","constraint":[]}},"defName":"validate-fungible-account","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"guard"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"guard"},{"var":{"f":{"var":{"b":1},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Account guard does not match"}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"seller-details","type":{"tag":"TypeVar","name":"am","constraint":[]},"info":null},"val":{"args":[{"args":[{"i":null,"lit":"account"},{"var":{"b":1},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"account","type":"string","info":{"d":[7,3356,3356],"c":"account"}}],"return":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":null,"name":"fungible-v2"},"name":"account-details","meta":{"model":[{"list":[{"atom":"invariant","q":[],"i":{"d":[10,283,283],"c":"invariant "}},{"list":[{"atom":"!=","q":[],"i":{"d":[3,294,294],"c":"!= "}},{"i":{"d":[3,297,297],"c":"\"\" "},"lit":""},{"atom":"sender","q":[],"i":{"d":[6,300,300],"c":"sender"}}],"d":"()","i":{"d":[14,293,293],"c":"(!= \"\" sender)"}}],"d":"()","i":{"d":[27,282,282],"c":"(invariant (!= \"\" sender)) "}}],"docs":"Schema for results of 'account' operation."},"i":{"d":[272,188,188],"c":"(defschema account-details\n    @doc \"Schema for results of 'account' operation.\"\n    @model [ (invariant (!= \"\" sender)) ]\n\n    account:string\n    balance:decimal\n    guard:guard)\n\n\n   ; ----------------------------------------------------------------------\n   ; Caps\n\n   "},"fields":[{"name":"account","type":"string","info":{"d":[7,316,316],"c":"account"}},{"name":"balance","type":"decimal","info":{"d":[7,335,335],"c":"balance"}},{"name":"guard","type":{"guard":null},"info":{"d":[5,355,355],"c":"guard"}}]}},"i":{"d":[15,3332,3332],"c":"account-details"}},"partial":"full"}},"defName":"details","defBody":{"scope":{"list":[],"type":"*","i":{"d":[164,3310,3310],"c":"(defun details:object{account-details}\n     ( account: string )\n     \" Get an object with details of ACCOUNT. \\\n     \\ Fails if account does not exist.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Get an object with details of ACCOUNT.  Fails if account does not exist."},"info":{"d":[164,3310,3310],"c":"(defun details:object{account-details}\n     ( account: string )\n     \" Get an object with details of ACCOUNT. \\\n     \\ Fails if account does not exist.\"\n     )\n\n   "}}},"i":null}},"i":null}},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.QUOTE.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":"event","funType":{"args":[{"name":"sale-id","type":"string","info":null},{"name":"token-id","type":"string","info":null},{"name":"spec","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-spec","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"partial":"full"},"info":null}],"return":"bool"},"defName":"QUOTE","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.CONCRETE-POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":"event","funType":{"args":[{"name":"policy-field","type":"string","info":null},{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}],"return":"bool"},"defName":"CONCRETE-POLICY","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce-guard"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.exists-msg-decimal.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"msg","type":"string","info":null}],"return":"bool"},"defName":"exists-msg-decimal","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"var":{"b":0},"i":null},{"i":null,"lit":-1}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"!="}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"d","type":"decimal","info":null},"val":{"args":[{"i":null,"lit":-1},{"args":[{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"read-msg"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"try"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Checks env-data field and see if the msg is a decimal"},"info":null}}],["marmalade-v2.policy-manager.WITHDRAW.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"WITHDRAW","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":"Capability to grant internal transaction inside WITHDRAW"},"info":null}}],["marmalade-v2.policy-manager.concrete-policy.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policy","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}]}}],["marmalade-v2.policy-manager.ADMIN-KS.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"ADMIN-KS","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"marmalade-v2.marmalade-contract-admin"},"eval":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.GUARD_POLICY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"GUARD_POLICY","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"guard-policy"},"eval":{"var":{"direct":{"pdval":"guard-policy"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.validate-quote.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"quote-spec","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"partial":"full"},"info":null}],"return":"bool"},"defName":"validate-quote","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.validate-fungible-account.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"var":{"b":0},"i":null}],"fun":{"dref":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"amount","type":"decimal","info":{"d":[6,3603,3603],"c":"amount"}}],"return":"bool"},"defName":"enforce-unit","defBody":{"scope":{"list":[],"type":"*","i":{"d":[120,3571,3571],"c":"(defun enforce-unit:bool\n     ( amount:decimal )\n     \" Enforce minimum precision allowed for transactions.\"\n     )\n\n   "}}},"module":{"namespace":null,"name":"fungible-v2"},"meta":{"model":[],"docs":" Enforce minimum precision allowed for transactions."},"info":{"d":[120,3571,3571],"c":"(defun enforce-unit:bool\n     ( amount:decimal )\n     \" Enforce minimum precision allowed for transactions.\"\n     )\n\n   "}}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"info":null},{"args":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null},{"i":null,"lit":""}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":0},"i":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":">"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Offer price must be positive"}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-sale.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":0},"i":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":">="}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Offer price must be positive or zero"}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}],"type":{"tag":"TypeVar","name":"an","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"if"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-price","type":"decimal","info":null},"val":{"args":[{"i":null,"lit":"sale-price"},{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"sale-type","type":"string","info":null},"val":{"args":[{"i":null,"lit":"sale-type"},{"var":{"f":{"var":{"f":{"var":{"b":0},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"f":{"var":{"f":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null}},"i":null}},"i":null},"partial":"full"},"info":null},"val":{"args":[{"i":null,"lit":"seller-fungible-account"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"fungible","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[{"i":null,"lit":"fungible"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.MINT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"MINT-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.BUY-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"BUY-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.quotes.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quotes","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"quote-schema","meta":{"model":[],"docs":"Quote spec of the sale"},"i":null,"fields":[{"name":"token-id","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"seller","type":"string","info":null},{"name":"timeout","type":"integer","info":null},{"name":"fungible","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":null,"name":"fungible-v2"}}},"i":null}]},"info":null},{"name":"seller-fungible-account","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"fungible-account","meta":{"model":[],"docs":"account and guard information of a fungible"},"i":null,"fields":[{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sale-price","type":"decimal","info":null},{"name":"sale-type","type":"string","info":null}]}},"i":null},"i":null}}],["marmalade-v2.policy-manager.enforce-init.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null}],"return":{"list":"bool"}},"defName":"enforce-init","defBody":{"scope":{"list":[{"body":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"precision"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"uri"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null}],"return":"bool"},"defName":"INIT-CALL","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"ledger-v2"},"meta":{"model":[],"docs":"Capability securing the modref call for enforce-init "},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"pairs":[{"arg":{"name":"ledger","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"ledger-v2"}}},"i":null}},"i":null}]},"info":null},"val":{"args":[],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.retrieve-ledger.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}}],"type":"let","i":null},{"args":[{"amArg":"`af6","amInfo":null,"amBindBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"precision"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"uri"},{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"b":0},"i":null}],"type":{"tag":"TypeVar","name":"i","constraint":[]},"i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"format"}},"i":null}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.INIT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null}},"i":null},"info":null},{"list":[{"args":[{"var":{"f":{"var":{"b":0},"i":null}},"i":null}],"fun":{"dref":{"var":{"b":0},"i":null},"i":null,"dmem":{"var":{"f":{"var":{"f":{"var":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null}],"return":"bool"},"defName":"enforce-init","defBody":{"scope":{"list":[],"type":"*","i":null}},"module":{"namespace":"kip","name":"token-policy-v2"},"meta":{"model":[],"docs":"Enforce policy on TOKEN initiation."},"info":null}},"i":null}},"i":null}},"i":null}},"info":null}],"type":"*","i":null}],"fun":{"var":{"f":{"var":{"f":{"var":{"direct":{"pdnat":"with-capability"}},"i":null}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"amTy":{"args":[{"name":"policy","type":{"modspec":[{"var":{"f":{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}},"i":null}]},"info":null}],"return":{"tag":"TypeVar","name":"h","constraint":[]}}},{"args":[{"i":null,"lit":"policies"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"map"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.TRANSFER-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[{"name":"id","type":"string","info":null},{"name":"sender","type":"string","info":null},{"name":"receiver","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"policy","type":"string","info":null}],"return":"bool"},"defName":"TRANSFER-CALL","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"policy-manager"},"meta":{"model":[],"docs":null},"info":null}}],["marmalade-v2.policy-manager.QUOTE-MSG-KEY.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"arg":{"name":"QUOTE-MSG-KEY","type":"string","info":null},"meta":{"model":[],"docs":"Payload field for quote spec"},"val":{"raw":{"i":null,"lit":"quote"},"eval":{"var":{"direct":{"pdval":"quote"}},"i":null}},"i":null}}],["marmalade-v2.policy-manager.concrete-policies.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}",{"ref":{"hash":"h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o","modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policies","meta":{"model":[],"docs":null},"type":{"var":{"ref":{"modname":{"namespace":"marmalade-v2","name":"policy-manager"},"name":"concrete-policy","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"policy","type":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]},"info":null}]}},"i":null},"i":null}}]],"module":{"hash":"xgy22oMMAttCcRlRx1R6yLXLtevZxXvYnXT-9MhD5pY","blessed":[],"interfaces":[{"namespace":"kip","name":"updatable-uri-policy-v1"},{"namespace":"kip","name":"token-policy-v2"}],"imports":[{"hash":null,"imports":["token-info"],"module":{"namespace":"kip","name":"token-policy-v2"},"i":null},{"hash":null,"imports":null,"module":{"namespace":"marmalade-v2","name":"policy-manager"},"i":null}],"name":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"code":"(module non-fungible-policy-v1 GOVERNANCE\n\n  @doc \"Concrete policy for issuing an nft with a fixed supply of 1 and precision of 0\"\n\n  (defconst ADMIN-KS:string \"marmalade-v2.marmalade-contract-admin\")\n  (defconst POLICY:string (format \"{}\" [non-fungible-policy-v1]))\n\n  (defcap GOVERNANCE ()\n    (enforce-guard ADMIN-KS))\n\n  (implements kip.token-policy-v2)\n  (implements kip.updatable-uri-policy-v1)\n\n  (use marmalade-v2.policy-manager)\n  (use kip.token-policy-v2 [token-info])\n\n  (defun enforce-init:bool\n    ( token:object{token-info}\n    )\n    (require-capability (INIT-CALL (at \"id\" token) (at \"precision\" token) (at \"uri\" token) POLICY))\n    (enforce (= 0 (at 'precision token)) \"Precision must be 0\")\n    true\n  )\n\n  (defun enforce-mint:bool\n    ( token:object{token-info}\n      account:string\n      guard:guard\n      amount:decimal\n    )\n    (require-capability (MINT-CALL (at \"id\" token) account amount POLICY))\n    (enforce (= amount 1.0) \"Mint can only be 1\")\n    (enforce (= (at 'supply token) 0.0) \"Only one mint allowed\")\n  )\n\n  (defun enforce-burn:bool\n    ( token:object{token-info}\n      account:string\n      amount:decimal\n    )\n    (enforce false \"Burn prohibited\")\n  )\n\n  (defun enforce-offer:bool\n    ( token:object{token-info}\n      seller:string\n      amount:decimal\n      timeout:integer\n      sale-id:string\n    )\n    true\n  )\n\n  (defun enforce-buy:bool\n    ( token:object{token-info}\n      seller:string\n      buyer:string\n      buyer-guard:guard\n      amount:decimal\n      sale-id:string )\n    true\n  )\n\n  (defun enforce-withdraw:bool\n    ( token:object{token-info}\n      seller:string\n      amount:decimal\n      timeout:integer\n      sale-id:string )\n    true\n  )\n\n  (defun enforce-transfer:bool\n    ( token:object{token-info}\n      sender:string\n      guard:guard\n      receiver:string\n      amount:decimal )\n    true\n  )\n\n  (defun enforce-update-uri:bool\n    ( token:object{token-info}\n      new-uri:string )\n      true\n  )\n\n)\n\n","meta":{"model":[],"docs":"Concrete policy for issuing an nft with a fixed supply of 1 and precision of 0"},"governance":{"capability":{"defType":"Defcap","defMeta":null,"funType":{"args":[],"return":{"tag":"TypeVar","name":"b","constraint":[]}},"defName":"GOVERNANCE","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce-guard"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":null},"info":null}}},"refMap":{"enforce-mint":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-mint","defBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null},{"var":{"b":1},"i":null},{"var":{"b":3},"i":null},{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.non-fungible-policy-v1"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.MINT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"var":{"b":3},"i":null},{"i":null,"lit":1}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Mint can only be 1"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"args":[{"i":null,"lit":"supply"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null},{"i":null,"lit":0}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Only one mint allowed"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"account","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null},{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":">","q":[],"i":null},{"atom":"amount","q":[],"i":null},{"i":null,"lit":0}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Minting policy for TOKEN to ACCOUNT for AMOUNT."},"info":null}},"enforce-burn":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"account","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-burn","defBody":{"scope":{"list":[{"args":[{"i":null,"lit":false},{"i":null,"lit":"Burn prohibited"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"account","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null},{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":">","q":[],"i":null},{"atom":"amount","q":[],"i":null},{"i":null,"lit":0}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Burning policy for TOKEN to ACCOUNT for AMOUNT."},"info":null}},"enforce-init":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null}],"return":"bool"},"defName":"enforce-init","defBody":{"scope":{"list":[{"args":[{"args":[{"args":[{"i":null,"lit":"id"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"precision"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null},{"args":[{"i":null,"lit":"uri"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null},{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.non-fungible-policy-v1"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdfv":"marmalade-v2.policy-manager.INIT-CALL.{h6JuhF9udyeGA1UCdLZBqQKEJdswsB-vYh1Dl-k462o}"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"require-capability"}},"i":null}},"i":null},"info":null},{"args":[{"args":[{"i":null,"lit":{"int":0}},{"args":[{"i":null,"lit":"precision"},{"var":{"b":0},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"at"}},"i":null}},"i":null},"info":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"="}},"i":null}},"i":null},"info":null},{"i":null,"lit":"Precision must be 0"}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce"}},"i":null}},"i":null},"info":null},{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":"Enforce policy on TOKEN initiation."},"info":null}},"ADMIN-KS":{"ref":{"modname":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"arg":{"name":"ADMIN-KS","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"i":null,"lit":"marmalade-v2.marmalade-contract-admin"},"eval":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"enforce-buy":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"buyer","type":"string","info":null},{"name":"buyer-guard","type":{"guard":null},"info":null},{"name":"amount","type":"decimal","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-buy","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":"Buy policy on SALE-ID by SELLER to BUYER AMOUNT of TOKEN."},"info":null}},"enforce-transfer":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"sender","type":"string","info":null},{"name":"guard","type":{"guard":null},"info":null},{"name":"receiver","type":"string","info":null},{"name":"amount","type":"decimal","info":null}],"return":"bool"},"defName":"enforce-transfer","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":" Enforce rules on transfer of TOKEN AMOUNT from SENDER to RECEIVER.  Also governs rotate of SENDER (with same RECEIVER and 0.0 AMOUNT). "},"info":null}},"POLICY":{"ref":{"modname":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"arg":{"name":"POLICY","type":"string","info":null},"meta":{"model":[],"docs":null},"val":{"raw":{"args":[{"i":null,"lit":"{}"},{"list":[{"var":{"ref":{"refSpec":[{"namespace":"kip","name":"updatable-uri-policy-v1"},{"namespace":"kip","name":"token-policy-v2"}],"refInfo":null,"refName":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"}}},"i":null}],"type":{"tag":"TypeVar","name":"a","constraint":[]},"i":null}],"fun":{"var":{"direct":{"pdnat":"format"}},"i":null},"info":null},"eval":{"var":{"direct":{"pdval":"marmalade-v2.non-fungible-policy-v1"}},"i":null}},"i":null}},"enforce-offer":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-offer","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":"Offer policy of sale SALE-ID by SELLER of AMOUNT of TOKEN."},"info":null}},"GOVERNANCE":{"ref":{"defType":"Defcap","defMeta":null,"funType":{"args":[],"return":{"tag":"TypeVar","name":"b","constraint":[]}},"defName":"GOVERNANCE","defBody":{"scope":{"list":[{"args":[{"var":{"f":{"var":{"ref":{"var":{"direct":{"pdval":"marmalade-v2.marmalade-contract-admin"}},"i":null}},"i":null}},"i":null}],"fun":{"var":{"f":{"var":{"direct":{"pdnat":"enforce-guard"}},"i":null}},"i":null},"info":null}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":null},"info":null}},"enforce-withdraw":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"seller","type":"string","info":null},{"name":"amount","type":"decimal","info":null},{"name":"timeout","type":"integer","info":null},{"name":"sale-id","type":"string","info":null}],"return":"bool"},"defName":"enforce-withdraw","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[],"docs":"Withdraw policy on SALE-ID by SELLER of AMOUNT of TOKEN"},"info":null}},"enforce-update-uri":{"ref":{"defType":"Defun","defMeta":null,"funType":{"args":[{"name":"token","type":{"schema":"object","type":{"var":{"ref":{"modname":{"namespace":"kip","name":"token-policy-v2"},"name":"token-info","meta":{"model":[],"docs":null},"i":null,"fields":[{"name":"id","type":"string","info":null},{"name":"supply","type":"decimal","info":null},{"name":"precision","type":"integer","info":null},{"name":"uri","type":"string","info":null},{"name":"policies","type":{"list":{"modspec":[{"var":{"ref":{"refSpec":null,"refInfo":null,"refName":{"namespace":"kip","name":"token-policy-v2"}}},"i":null}]}},"info":null}]}},"i":null},"partial":"full"},"info":null},{"name":"new-uri","type":"string","info":null}],"return":"bool"},"defName":"enforce-update-uri","defBody":{"scope":{"list":[{"i":null,"lit":true}],"type":"*","i":null}},"module":{"namespace":"marmalade-v2","name":"non-fungible-policy-v1"},"meta":{"model":[{"list":[{"atom":"property","q":[],"i":null},{"list":[{"atom":"!=","q":[],"i":null},{"atom":"new-uri","q":[],"i":null},{"i":null,"lit":""}],"d":"()","i":null}],"d":"()","i":null}],"docs":"Updating the URI of a token."},"info":null}}}}
